{% extends "base.html" %}
{% load i18n static humanize %}

{% block page_title %}
{% trans 'ご購入の手続き' %}
{% endblock page_title %}

{% block content %}
<div class="min-h-75vh rounded-xl mx-auto py-16"
    style="background-image: url({% static 'images/pattern.svg' %}); background-repeat: repeat;">
    <div class="w-5/6 flex flex-col items-center container mx-auto bg-white p-12 my-10 rounded-xl relative">
        <div class="flex items-center justify-center bg-indigo-600 w-24 h-24 rounded-full absolute" style="top: -3rem;">
            <i class="fas fa-shopping-bag fa-3x text-white"></i>
        </div>
        <h2 class="text-indigo-800 mt-3 mb-5 text-3xl font-semibold text-center">
            {% trans 'ご購入の手続き' %}
        </h2>
        <div class="w-full flex">
            <div class="w-2/3 flex flex-wrap mb-10">
                <form method="POST" class="w-3/4 mx-auto py-5">
                    {% csrf_token %}
                    <h3 class="w-full font-semibold text-xl bg-gray-900 p-3 text-white rounded-t-lg">
                        {% trans '1. お届け先情報' %}
                    </h3>
                    <div class="border border-gray-500 px-4 pb-2">
                        <h4 class="pt-2 font-semibold mb-2">{% trans '配送先住所' %}</h4>
                        <span
                            class="pt-1">{{ recipient_data.last_name_recipient }}　{{ recipient_data.first_name_recipient }}</span>
                        <span
                            class="pt-1">({{ recipient_data.last_name_recipient_kana }}　{{ recipient_data.first_name_recipient_kana }})</span>
                        <div class="pt-1">
                            {{ recipient_data.phone_number_recipient }}
                        </div>
                        <div class="pt-1">
                            {{ recipient_data.postal_code_recipient }}
                        </div>
                        <div class="pt-1 mb-3">
                            {{ recipient_pref }}
                            {{ recipient_data.address_city_recipient }}
                            {{ recipient_data.address_detail_recipient }}
                        </div>
                    </div>

                    <h3 class="w-full font-semibold text-2xl text-white bg-gray-900 p-3 rounded-t-lg mt-5">
                        {% trans '2. お支払い方法・ご請求先情報' %}</h3>
                    <div class="border border-gray-500 px-4 pb-2">
                        <div class="w-full pb-5">
                            <h4 class="pt-2 font-semibold mb-2">{% trans 'お支払い方法の選択' %}</h4>
                            <div class="flex">
                                <ul class="radio-group flex mt-5">
                                    {% for radio in orderer_form.payment %}
                                    <li class="radio-list relative">
                                        {{ radio.tag }}
                                        <label for="id_payment_{{ forloop.counter0 }}">{{ radio.choice_label }}</label>
                                        <div class="check">
                                            <div class="inside"></div>
                                        </div>
                                    </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <div id="for_card" class="hidden mb-4">
                            <h4 class="font-semibold mb-2">{% trans '請求先情報' %}</h4>
                            <div class="flex items-center rounded">
                                {{ orderer_form.is_same_with_recipient }}　<span>{% trans '請求先住所が配送先と同じ' %}</span>
                            </div>
                        </div>
                        <div id="for_transfer" class="hidden border-2 mb-3">
                            <h4 class="p-2 font-semibold">{% trans '振込先案内' %}</h4>
                            <div class="pb-2 px-2 text-center text-indigo-800">
                                <div>
                                    {% trans '振込先：OO銀行' %}
                                </div>
                                <div>
                                    {% trans '支店名：OOO支店(支店番号111)' %}
                                </div>
                                <div>
                                    {% trans '取引種類：普通' %}
                                </div>
                                <div>
                                    {% trans '口座番号：XXX-XXXX' %}
                                </div>
                                <div>
                                    {% trans '口座名義：UNIWALK' %}
                                </div>
                            </div>
                        </div>
                        <div id="address_orderer" class="hidden">
                            <div class="flex mb-5">
                                <div class="mr-5 border rounded px-3 py-1">
                                    {{ orderer_form.last_name_orderer }}
                                </div>
                                <div class="mr-5 border rounded px-3 py-1">
                                    {{ orderer_form.first_name_orderer }}
                                </div>
                            </div>
                            <div class="flex mb-5">
                                <div class="mr-5 border rounded px-3 py-1">
                                    {{ orderer_form.last_name_orderer_kana }}
                                </div>
                                <div class="mr-5 border rounded px-3 py-1">
                                    {{ orderer_form.first_name_orderer_kana }}
                                </div>
                            </div>
                            <div class="mb-5">
                                {{ orderer_form.email }}
                            </div>
                            <div class="mb-5 border rounded px-3 py-1">
                                {{ orderer_form.phone_number_orderer }}
                            </div>
                            <div class="mb-5 border rounded px-3 py-1">
                                {{ orderer_form.postal_code_orderer }}
                            </div>
                            <div class="floating-label select mb-5 border rounded px-3 py-2">
                                {{ orderer_form.prefecture_orderer }}
                            </div>
                            <div class="mb-5 border rounded px-3 py-1">
                                {{ orderer_form.address_city_orderer }}
                            </div>
                            <div class="mb-5 border rounded px-3 py-1">
                                {{ orderer_form.address_detail_orderer }}
                            </div>
                        </div>
                        <button class="btn my-5">{% trans 'ご注文内容の確認へ' %}</button>
                    </div>
                    <h3 class="w-full font-semibold text-xl text-white bg-gray-900 p-3 mt-5 rounded-lg">
                        {% trans '3. ご注文の確定' %}
                    </h3>
                </form>
            </div>

            <div
                class="w-1/3 flex flex-col h-full p-5 shadow-lg justify-between text-white bg-gray-900 rounded-xl my-5 mr-10">
                {% include "mixins/orders/order-summary-card.html" %}
            </div>
        </div>
    </div>
</div>

<script>
    const method_card = document.querySelector("#id_payment_0");
    const method_transfer = document.querySelector("#id_payment_1");
    const for_card = document.querySelector("#for_card");
    const for_transfer = document.querySelector("#for_transfer");
    const check_orderer = document.querySelector("#id_is_same_with_recipient");
    const address_orderer = document.querySelector("#address_orderer");

    method_card.addEventListener("change", () => {
        for_card.classList.remove("hidden");
        for_transfer.classList.add("hidden");
    });

    method_transfer.addEventListener("change", () => {
        for_transfer.classList.remove("hidden");
        for_card.classList.add("hidden");
        address_orderer.classList.add("hidden");
        check_orderer.checked = true;
    });

    check_orderer.addEventListener("change", () => {
        address_orderer.classList.toggle("hidden");
    });
</script>
{% endblock content %}